install.packages("D:/downloads/RODBC_1.3-14.zip", repos = NULL, type = "win.binary")
install.packages("D:/downloads/asterR/sles_R-3.1.2_rpms.tar", repos = NULL)
install.packages("D:/downloads/asterR/sles_R-3.1.2_rpms.tar", repos = NULL, type="source")
install.packages("D:/downloads/asterR/AsterClients__windows_i386.06.22.01.00/AsterClients__windows_i386.06.22.01.00/AsterClients__windows_i386.06.22.01.00/stage/home/beehive/clients-win32/TeradataAsterR_06.22.00.00.zip", repos = NULL, type = "win.binary")
setwd("D:\\workspace\\bioinformatics\\BIOLF449\\INFOF434")
fa <- readDNAStringSet('genome.fa')
chr21 <-fa$chr21
chr22 <- fa$chr22
fa <- readDNAStringSet('genome.fa')
setwd("D:\\workspace\\bioinformatics\\BIOLF449\\INFOF434")
fa <- readDNAStringSet('genome.fa')
library(stringr)
biocLite("Biostrings")
library('Biostrings')
fa <- readDNAStringSet('genome.fa')
chr21 <-fa$chr21
chr22 <- fa$chr22
t <- read.table('data', header = T, comment.char = '')[,-1]
codingAnnotations <- function(chromosomeName, strand){
annotation <- t[t$chrom == chromosomeName, ]
annotation <- annotation[annotation$strand == strand, ]
annotation <- annotation[grep('NM', annotation$name),]
annotation
}
annotation_21_plus <- codingAnnotations('chr21', '+')
annotation_21_plus
codingAnnotationsByChromosomeAndStrand <- function(chromosomeName, strand){
annotation <- t[t$chrom == chromosomeName, ]
annotation <- annotation[annotation$strand == strand, ]
annotation <- annotation[grep('NM', annotation$name),]
annotation
}
annotation_21_plus <- codingAnnotationsByChromosomeAndStrand('chr21', '+')
startCodon21plus <- DNAStringSet(chr21, start= annotation_21_plus$cdsStart + 1, end = annotation_21_plus$cdsStart + 3)
startCodon21plus
annotation_21_minus <- codingAnnotationsByChromosomeAndStrand('chr21', '-')
table(startCodon21plus)
startCodon21minus <- DNAStringSet(chr21, start= annotation_21_minus$cdsStart - 2, end = annotation_21_minus$cdsStart)
startCodon21minus
x<-reverseComplement(startCodon21minus)
x
table(x)
table(startCodon21plus)
startCodon21minus <- reverseComplement(DNAStringSet(chr21, start= annotation_21_minus$cdsStart - 2, end = annotation_21_minus$cdsStart))
startCodon21minus
table(startCodon21minus)
x<-DNAStringSet(chr21, start= annotation_21_minus$cdsStart - 2, end = annotation_21_minus$cdsStart)
x
x<-DNAStringSet(chr21, start= annotation_21_minus$cdsStart - 2, end = annotation_21_minus$cdsStart)[1:5]
x
y<-reverseComplement(x)
y
startCodon21minus <- reverseComplement(DNAStringSet(chr21, start= annotation_21_minus$cdsStart - 3, end = annotation_21_minus$cdsStart-1))
table(startCodon21minus)
startCodon21minus <- reverseComplement(DNAStringSet(chr21, start= annotation_21_minus$cdsStart -2, end = annotation_21_minus$cdsStart))
table(startCodon21minus)
startCodon21minus <- reverseComplement(DNAStringSet(chr21, start= annotation_21_minus$cdsStart -1, end = annotation_21_minus$cdsStart+1))
table(startCodon21minus)
startCodon21minus <- reverseComplement(DNAStringSet(chr21, start= annotation_21_minus$cdsStart , end = annotation_21_minus$cdsStart+2))
table(startCodon21minus)
startCodon21minus <- reverseComplement(DNAStringSet(chr21, start= annotation_21_minus$cdsStart+1 , end = annotation_21_minus$cdsStart+3))
table(startCodon21minus)
startCodon21minus <- reverseComplement(DNAStringSet(chr21, start= annotation_21_minus$cdsStart -2 , end = annotation_21_minus$cdsStart))
table(startCodon21minus)
annotation_22_plus <- codingAnnotationsByChromosomeAndStrand('chr22', '+')
annotation_22_minus <- codingAnnotationsByChromosomeAndStrand('chr22', '-')
startCodon22plus <- DNAStringSet(chr22, start= annotation_22_plus$cdsStart + 1, end = annotation_22_plus$cdsStart + 3)
startCodon22minus <- reverseComplement(DNAStringSet(chr22, start= annotation_22_minus$cdsStart -2 , end = annotation_22_minus$cdsStart))
table(startCodon23plus)
table(startCodon22plus)
table(startCodon22minus)
startCodonsPlus<-function(chr, annotations){
startCodon <- DNAStringSet(chr, start= annotations$cdsStart + 1, end = annotations$cdsStart + 3)
startCodon
}
startCodonsMinus<-function(chr, annotations){
startCodon <- DNAStringSet(chr, start= annotations$cdsStart -2, end = annotations$cdsStart)
startCodon
}
startCodonsMinus<-function(chr, annotations){
startCodon <- reverseComplement(DNAStringSet(chr, start= annotations$cdsStart -2, end = annotations$cdsStart))
startCodon
}
startCodon21plus <- startCodonsPlus(chr21, annotation_21_plus)
startCodon21minus <- startCodonsMinus(chr22, annotation_21_minus)
table(startCodon21plus)
table(startCodon21minus)
startCodon22plus <- startCodonsPlus(chr22, annotation_22_plus)
startCodon22minus <- startCodonsMinus(chr22, annotation_22_minus)
table(startCodon21minus)
table(startCodon21plus)
table(startCodon22plus)
table(startCodon22minus)
counts21 <- str_count(chr21, c('A', 'C', 'G', 'T'))
counts21
counts22 <- str_count(chr22, c('A', 'C', 'G', 'T'))
counts22
cgPercentage21 <- CGpercentage(chr21)
CGpercentage <- function(chr){
total <- str_count(chr, c('A', 'C', 'G', 'T'))
c_g_total <- total[2] + total[3]
c_g_percentage <- (c_g_total * 100) / sum(total)
c_g_percentage
}
cgPercentage21 <- CGpercentage(chr21)
cgPercentage21
cgPercentage22 <- CGpercentage(chr22)
cgPercentage22
firstCodonsPlus<-function(chr, annotations){
startCodon <- DNAStringSet(chr, start= annotations$cdsStart + 1, end = annotations$cdsStart + 6)[1:5]
startCodon
}
firstCodon21plus <- firstCodonsPlus(chr21, annotation_21_plus)
firstCodon21plus
firstCodon21minus <- firstCodonsPlus(chr21, annotation_21_minus)
firstCodon21minus
firstCodonsPlus<-function(chr, annotations){
startCodon <- DNAStringSet(chr, start= annotations$cdsStart + 1, end = annotations$cdsStart + 6)[1:5]
startCodon <- startCodon[grep('TTA', startCodon),]
startCodon
}
firstCodon21minus <- firstCodonsPlus(chr21, annotation_21_minus)
firstCodon21minus
firstCodonsPlus<-function(chr, annotations){
startCodon <- DNAStringSet(chr, start= annotations$cdsStart + 1, end = annotations$cdsStart + 6)[1:5]
startCodon <- startCodon[grep('TTA', startCodon),]
startCodon <- startCodon[3:5]
startCodon
}
firstCodon21minus <- firstCodonsPlus(chr21, annotation_21_minus)
firstCodon21minus
?substring
firstCodonsPlus<-function(chr, annotations){
startCodon <- DNAStringSet(chr, start= annotations$cdsStart + 1, end = annotations$cdsStart + 6)[1:5]
startCodon <- startCodon[grep('TTA', startCodon),]
startCodon <- substring(startCodon, first = 4, last = 6)
startCodon
}
firstCodon21minus <- firstCodonsPlus(chr21, annotation_21_minus)
firstCodon21minus
table(firstCodon21minus)
firstCodonsPlus<-function(chr, annotations){
startCodon <- DNAStringSet(chr, start= annotations$cdsStart + 1, end = annotations$cdsStart + 6)
startCodon <- startCodon[grep('ATG', startCodon),]
startCodon <- substring(startCodon, first = 4, last = 6)
startCodon
}
firstCodon21plus <- firstCodonsPlus(chr21, annotation_21_plus)
firstCodon21plus
table(firstCodon21plus)
hist(firstCodon21plus, nclass =10, col = 'red', main ="First codon distribution",
xlab = 'First codon', ylab = 'Frequency')
